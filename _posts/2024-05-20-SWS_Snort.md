---
Title: SWS TryHackme Snort
categories: [Snort, learning outcomes]
tags: [Cyber sercurity]
---

### Topic : Snort


# Introduction

Snort, which is an open source network IDS, successfully deployed as the first line of defense in a network security systems since it is primarily designed to detect and analyze traffic anomalies. Rules from this application are crucial since it defines its effectiveness; therefore, the rules configured in Snort should be effective in the sense that they’d capture every event that could be of importance to an analyst. These rules set predictable patterns and actions that are precursors of threats to be recognized and intercepted. It is important for any security administrator to have the understanding of how the Snort rules works In this chapter, the prospective for Snort rule creation and usage is discussed. This paper focuses on analyzing Snort rules that were found in the network, the identification codes on these rules and the development of a new rule to enhance the detection.


#### Traffic Sniffing:
 Packet Sniffer is one of the ways through which Snort can be used in order to capture and analyze packets in a network. This particular task focuses on guides users through the process of configuring Snort in a way that allows the application to capture and display the contents of packet traffic in real-time.

#### Traffic Logging:
 In this mode, Snort simply saves the packets as a file for later analysis or further investigation. To enhance this capability, users are enlightened on how to set the Snort software to dump captured packets onto log files which can be analyzed to detect any suspicious activity.

#### Network-Based Intrusion Detection:
 Within this section, Snort is considered as IDS to identify potential invasions on a given network. It includes features like writing and compiling the rules that Snort uses to detect different attack tunnels and passing alerts.

#### Network-Based Intrusion Prevention:
 From defending simply detection, this segment acquaints users with Snort in inline mode on how it can prohibit traffic actively. This is done in order to prevent scheming attacks before they are able to penetrate through the network.

#### PCAP Investigation: 
Participants learn how to use Snort for interfaces with particular reference to analysis of PCAP files. In this capacity, it is essential to analyze captured traffic for evidence of threats and learn the meaning of various kind of alerts provided by Snort.

#### Custom Rule Creation:
 WritingRULES is essential if one needs to apply Snort with an emphasis on certain network scenarios. This task helps the users in understanding the process of writing Inline rules that can help in detecting unique Threats thus making Snort more flexible.

#### Practical Challenges: 
The module also features practical task and case where the users have to apply what learnt to real-life difficulties. They help to determine not only how well Snort has been set up and how it is possible to interpret received alerts, but the overall competence in responding to threats.

## Research on the “local. rules” file and determine for which SID the ICMP alert is specified.

First of all, let’s look at the “local. rules” file, which guides extending the standard set of rules, optimized for working in particular network settings. This is given as the algorithm Security ID (SID) that Snort uses in order to manage and monitor the alert rules generated by it.

Command:
#### sudo gedit /etc/snort/rules/local. rules

When viewing the contents of “local. rules” document, we can identify a rule that should target ICMP traffic. The Internet Control Message Protocol or ICMP is employed to diagnose network problems, Nonetheless, it can was well used for probing and over flooding attacks. The rule in question is:The rule in question is:

Command:
#### alert icmp any any -> any any (msg: "ICMP Packet Found"; sid:100001; rev:1;)

SID for ICMP alert rule: The state of the art in targets-conditions performance is Master in Management, candidate number 100001.

This rule produces an alert when it encounters any ICMP packet in the network and it sends a General message of its alert as ‘Indeed an ICMP Packet has been detected’.

##  Local Rules Investigation The HTTP alert rule is available under the local. rules file where you should be able to find its SID.

Next, we open the “local. rules” file and look to see what the SID of the new HTTP alert rule is. Another direction of transmitted traffic – HTTP – is also complex, but remains the primary object of various versions of injections (SQL) and scripts (XSS), as well as other Web-related threats.

The relevant rule found in the file is:The relevant rule found in the file is:

Command:
#### alert tcp any any -> any 80 (msg: "HTTP Packet Found"; sid:100002; rev:1;)

SID for HTTP alert rule: Here is another notational representation: 100002

iting an alert for any TCP traffic to port 80 which is the default port that is associated with traffic that is flowing to and from web browsers, assists security analysts to monitor and identify web based threats.

## Go to the “local. rules” file and determine which alert rule is related to SSH and what is its SID number?

Further, the investigation goes to determine the SID for the SSH alert rule. The SSH protocol is often employed for remote system administration and data transfer, but it is also vulnerable to a hacking technique termed as brute force attack where an unauthorized user attempts multiple login credentials in the pursuit of a valid one.

The SSH alert rule present in the "local. rules" file is:The SSH alert rule present in the "local. rules" file is:

Command:
#### alert tcp any any -> any 22 (msg: "SSH Packet Found"; sid:100003; rev:1;)

SID for SSH alert rule: The first digit, on the other hand, represents the class 10000; the next two digits, 00, represent the subclass 20000; hence, the figure 100003 can be interpreted as the original form of the number 100003 as 10000*20000+3000=20003000.

This rule is based on a pattern that matches any TCP traffic originating or destined for port 22, which is the default port for Secure SHell and it help in identifying possible unauthorized access attempts.

The third step is to develop new Snort Rules where some general guidelines followed for creating Snort Rules are shown below:

In order to improve the performance of Snort logs, one can create additional new rules that we may require according to our security requirements. To illustrate this, let us create a new rule which will trigger an alert should any ICMP traffic be noted.

Command:

#### sudo gedit /etc/snort/rules/local. rules

New Rule to Add:

Command:

#### alert icmp any any -> any any (msg: "ICMP Packet Found"; sid:100004; rev:1;)

This new rule is similar to the one in place before it in that it is intended to alert on any ICMP traffic, however, it does so with a new SID of 100004. Such a system helps avoid conflict of interest with the other rules while offering an efficient way of managing Snort rules.

Testing the New Rule

The final step after sharing a new rule is to check the correct operation of the new rule. The generated configuration file can be now used to run Snort, and thus check if the rule is followed whenever the ICMP traffic is identified.

Command:

#### sudo snort -c /etc/snort/snort. conf -A console without -i eth0

For example, performing a ping to a remote server will ease the identification of Snort console’s output for the new ICMP rule.

## Conclusion

The ability to manage rules for Snort is one of the most essential ways that can ensure effective network security. As described in this report, the process of preparing the information below is indicative of the significance of discovering what types of guidelines and standards exist and how they are named, as well as where they can be located. Thus, different rules can be created to provide network administrators with the necessary means of ensuring that each rule meets its intended functionality without the interference of other rules.

These facts represent the potential to create new rules, custom rules based on distinct requirements for network protection, which enhance visualization and identification of threats. The new ICMP rule introduced in Snort shows how it is possible to increase the detection possibilities offered by Snort and at the same time organize rules following a regular scheme based on five-fold differentiation.

It only requires Snort rules to be updated and tested frequently to ensure that rules on emerging threats are included. In a continuum as new threats emerge and advanced techniques are identified, the Snort rules must have effective defenses for them. It also involves taking preventive measures against possible compromises to the set up of the network to ensure that it remains secure.

All in all, it can be stated that the proper approbation of the Snort rules as well as its constant improving is critical for threats identification and prevention. Therefore, through setting new rules, assessing existing ones and being scientific throughout the process, the specialists that develop and maintain the network security have the best chance of offering a watertight intrusion detection system.


